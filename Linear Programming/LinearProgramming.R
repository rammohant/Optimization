# Linear Programming Notes: McDonald's and Production Problems
# 9.23.2021

install.packages ("lpSolve") # once per machine
library (lpSolve)

f_obj1 <- c(1,-3) # x1 - 3x2
f_A1 <- matrix( c(-1,2,1,1), 
                nrow = 2,
                byrow = TRUE )
f_B1 <- c(6,5)
f_Q1 <- c("<=", "<=")

# lpSolve ("min", c, A, <=, b) gives minimized value
# $ talks to something on the object 
lpSolve::lp("min", f_obj1, f_A1, f_Q1, f_B1)$solution

lp <- lpSolve::lp("min", f_obj1, f_A1, f_Q1, f_B1)
lp$solution

##########################################
# McDonalds Problem 
##########################################
c1 <- c(1.39, 1.99, 1.00, 3.79)
a1 <- matrix( c(-220,-170,-300,-379,
                10,10,14,20,
                180,330,745,582), 
              nrow = 3, 
              byrow = TRUE)

b1 <- c(-1000,46,2300)
q1 <- c( "<=", "<=", "<=" )
lp2 <- lpSolve::lp("min", c1, a1, q1, b1)
lp2$solution

##########################################
# Fuel Distribution Problem 9/28/21
##########################################

c1 <- c(14.99827, #a1
        14.9979618, #a2
        14.996611, #a3
        14.995757, #a4
        14.992416, #a5
        15.9930201, #b1
        15.9948984, #b2
        15.9955867, #b3
        15.9949644, #b4
        15.9988419) #b5
#               a1 a2 a3 a4 a5 b1 b2 b3 b4 b5 
a1 <- matrix( c(1, 0, 0, 0, 0, 1, 0, 0, 0, 0,
                0, 1, 0, 0, 0, 0, 1, 0, 0, 0,
                0, 0, 1, 0, 0, 0, 0, 1, 0, 0,
                0, 0, 0, 1, 0, 0, 0, 0, 1, 0,
                0, 0, 0, 0, 1, 0, 0, 0, 0, 1,
                1, 1, 1, 1, 1, 0, 0, 0, 0, 0,
                0, 0, 0, 0, 0, 1, 1, 1, 1, 1),
              nrow = 7, 
              byrow = TRUE)
b1 <- c(1307,
        1296,
        732,
        2763,
        3326,
        5713,
        4293)
q1 <- c(">=", 
        ">=", 
        ">=",
        ">=", 
        ">=", 
        "<=", 
        "<=")
lp2 <- lpSolve::lp("max",c1, a1,q1,b1)
lp2$solution

a1%%x_sol1

##########################################
# Production Problem 9/30/21
##########################################

# prices 
c2 <- c(375, #A1
        993.5, #A2
        159, #A3
        450, #B1
        0, #B2
        212, #B3
        0, #C1
        3477.25, #C2
        212, #C3
        937, #D1
        0, #D2
        106) #D3

#             A1 A2 A3 B1 B2 B3 c1 c2 c3 D1 D2 D3     
A2 <- matrix(c(1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
               0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0,
               0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0,
               0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1,
               100, 0, 0, 120, 0, 0, 0, 0, 0, 250, 0, 0,
               0, 50, 0, 0, 0, 0, 0, 175, 0, 0, 0, 0,
               0, 0, 75, 0, 0, 100, 0, 0, 100, 0, 0, 50), 
             nrow = 7, byrow =TRUE)
b2 <- c(24,
        24,
        24,
        24,
        2500,
        1200,
        4500)
q2 <- c("<=",
        "<=",
        "<=",
        "<=",
        ">=",
        ">=",
        ">=")

lp3 <- lpSolve::lp("max",c2,A2,q2,b2)
sol2 <- lp3$solution

A2%%sol2

sol2


##########################################
# Homework 5
##########################################

# Rates of each product in litres per hour 
c3 <- c(523, #A1
        419, #A2
        563, #A3
        315, #A4
        292, #A5
        312, #A6
        721, #B1
        615, #B2
        709, #B3
        0, #B4
        0, #B5
        314, #B6
        639, #C1
        492, #C2
        515, #C3
        0, #C4
        0, #C5
        309, #C6
        0, #D1
        0, #D2
        0, #D3
        330, #D4
        407, #D5
        291  #D6
        ) 


#             A1 A2 A3 A1 A2 A3 B1 B2 B3 B1 B2 B3 c1 c2 c3 c1 c2 c3 D1 D2 D3 D1 D2 D3     
A3 <- matrix(c( 523, 0, 0, 0, 0, 0, 721, 0, 0, 0, 0, 0, 639, 0, 0, 0, 0, 0, 0  , 0, 0, 0, 0, 0, 
                0, 419, 0, 0, 0, 0, 0, 615, 0, 0, 0, 0, 0, 492, 0, 0, 0, 0, 0, 0  , 0, 0, 0, 0, 
                0, 0, 563, 0, 0, 0, 0, 0, 709, 0, 0, 0, 0, 0, 515, 0, 0, 0, 0, 0, 0  , 0, 0, 0, 
                0, 0, 0, 315, 0, 0, 0, 0, 0, 0  , 0, 0, 0, 0, 0, 0  , 0, 0, 0, 0, 0, 330, 0, 0, 
                0, 0, 0, 0, 292, 0, 0, 0, 0, 0, 0  , 0, 0, 0, 0, 0, 0  , 0, 0, 0, 0, 0, 407, 0, 
                0, 0, 0, 0, 0, 312, 0, 0, 0, 0, 0, 314, 0, 0, 0, 0, 0, 309, 0, 0, 0, 0, 0, 291, 
                1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
               0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
               0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0,
               0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1
              ), 
             nrow = 10, byrow =TRUE)

b3 <- c(21000,
        5000,
        2000,
        1200, 
        1400,
        4300,
        24,
        24,
        24,
        24)
q3 <- c( ">=",
         ">=",
         ">=",
         ">=",
         ">=",
         ">=",
         "<=",
        "<=",
        "<=",
        "<="
       )

lp4 <- lpSolve::lp("min",c3,A3,q3,b3)
sol3 <- lp4$solution

A3%%sol3

sol3
